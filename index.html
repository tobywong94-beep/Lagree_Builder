<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Lagree Routine Builder</title>

  <!-- PWA / iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Lagree Builder">
  <link rel="apple-touch-icon" href="apple-touch-icon-180.png">
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b0d10">

  <style>
    html, body { height: 100%; }
    body { margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; background:#0b0d10; color:#e6edf3; }
    .app { min-height: 100vh; display: grid; grid-template-columns: 1fr; }
    .sidebar { position: sticky; top:0; z-index:2; border-bottom:1px solid #1f2630; background:rgba(18,22,28,0.9); backdrop-filter: blur(6px); padding:12px; }
    .content { padding:12px; }
    .btn { display:inline-flex; align-items:center; gap:8px; min-height:44px; padding:10px 12px; background:#7aa2ff; color:#081120; border-radius:10px; border:0; font-weight:800; }
    .btn.secondary { background:#1b2534; color:#e6edf3; border:1px solid #1f2630; }
    input, select, textarea { width:100%; min-height:44px; padding:12px; border-radius:10px; border:1px solid #1f2630; background:#0f1319; color:#e6edf3; }
    .panel { background:#12161c; border:1px solid #1f2630; border-radius:12px; padding:12px; }
    @media (min-width: 900px) { .app { grid-template-columns: 320px 1fr; } .sidebar{ height:100vh; border-right:1px solid #1f2630; border-bottom:0; } }
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <h1 style="margin:0 0 6px 0; font-size:18px">Lagree Library</h1>
      <div style="color:#9aa4b2; font-size:12px">Build, time, and print your routines. Autosaves offline.</div>
      <div style="height:8px"></div>
      <button class="btn" id="newRoutineBtn">＋ New</button>
      <button class="btn secondary" id="exportBtn">Export</button>
      <label class="btn secondary" for="importInput">Import</label>
      <input id="importInput" type="file" accept="application/json" style="display:none"/>
      <div style="height:8px"></div>
      <input id="search" type="text" placeholder="Search…"/>
      <div style="display:flex; gap:8px; margin-top:8px">
        <select id="filterCategory"><option value="">All</option><option>Signature</option><option>Advanced</option><option>Flex</option><option>Beginner</option></select>
        <select id="sortOrder"><option value="updated">Updated</option><option value="created">Created</option><option value="title">Title</option></select>
      </div>
      <div style="height:8px"></div>
      <div id="routineList"></div>
    </aside>
    <main class="content">
      <div id="crumbs" style="color:#9aa4b2; font-size:12px">No routine selected</div>
      <div style="height:8px"></div>
      <div id="editor" class="panel" style="display:none">
        <div style="display:grid; gap:10px">
          <input id="titleInput" type="text" placeholder="Title (e.g., 40-min Signature: LL → LO → RL → RO → Arms → Core)"/>
          <div style="display:flex; gap:10px">
            <select id="categoryInput"><option>Signature</option><option>Advanced</option><option>Flex</option><option>Beginner</option></select>
            <input id="tagsInput" type="text" placeholder="tags, comma-separated"/>
          </div>
          <div id="blocksContainer" style="display:grid; gap:10px"></div>
          <div style="display:flex; gap:8px; flex-wrap:wrap">
            <span style="background:#0d1826; border:1px solid #1f2630; padding:8px 10px; border-radius:999px; font-weight:800">Routine: <span id="totalTime">00:00</span></span>
            <span style="background:#0d1826; border:1px solid #1f2630; padding:8px 10px; border-radius:999px; font-weight:800">Moves: <span id="totalMoves">0</span></span>
            <span style="background:#0d1826; border:1px solid #1f2630; padding:8px 10px; border-radius:999px; font-weight:800">Blocks: <span id="totalBlocks">0</span></span>
          </div>
        </div>
      </div>
      <div id="emptyState" class="panel">
        <b>Create a routine to get started.</b>
        <div style="color:#9aa4b2; font-size:12px">Pick the category and number of blocks, then add timed moves. Totals update live.</div>
        <div style="height:8px"></div>
        <button class="btn" id="emptyNewBtn">＋ New routine</button>
      </div>
    </main>
  </div>

  <!-- New Routine Drawer (simple) -->
  <div id="newModal" style="display:none; position:fixed; left:0; right:0; bottom:0; background:rgba(10,14,20,.97); border-top:1px solid #1f2630; padding:12px;">
    <div class="panel" style="max-width:720px; margin:0 auto;">
      <h2 style="margin:0 0 8px 0">New Routine</h2>
      <div style="color:#9aa4b2; font-size:12px">Choose routine type, # blocks, and names.</div>
      <div style="display:flex; gap:10px; margin-top:10px">
        <select id="newCategory"><option>Signature</option><option>Advanced</option><option>Flex</option><option>Beginner</option></select>
        <input id="newBlockCount" type="number" min="1" max="12" value="6"/>
      </div>
      <div style="margin-top:10px; font-weight:800">Block Names</div>
      <div id="newBlockNames" style="display:grid; gap:8px"></div>
      <div style="display:flex; gap:8px; justify-content:flex-end; margin-top:10px">
        <button class="btn secondary" id="cancelNew">Cancel</button>
        <button class="btn" id="createNew">Create</button>
      </div>
    </div>
  </div>

  <script>
    // Register SW; it avoids caching app.js too aggressively
    if ('serviceWorker' in navigator) { navigator.serviceWorker.register('sw.js'); }
  </script>
  <script defer src="app.js?v=1755228459"></script>
</body>
</html>
